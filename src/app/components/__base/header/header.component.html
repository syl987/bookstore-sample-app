<mat-toolbar class="mat-elevation-z8">
  <mat-toolbar-row>
    <ng-container *ngIf="desktop$ | async; else mobile">
      <div class="text-primary fs-large me-s">{{ options.applicationName }}</div>

      <a mat-button *ngFor="let link of PUBLIC_LINKS" color="primary" [routerLink]="link.path" routerLinkActive="active">{{ link.label }}</a>

      <form [formGroup]="form" (ngSubmit)="search()">
        <mat-form-field appearance="fill" style="min-width: 268px">
          <mat-icon fontIcon="fa-search" inline class="text-primary" matPrefix />
          <input matInput formControlName="query" placeholder="Search..." aria-label="Search" i18n-placeholder i18n-aria-label />
          <mat-spinner *ngIf="searching$ | async" diameter="24" class="me-s" matSuffix />
        </mat-form-field>
      </form>

      <span class="ms-2xs me-auto"></span>

      <ng-container *ngIf="user$ | async as user; else public">
        <button mat-button (click)="openUserSessionInfoDialog(user)">
          <app-header-user-info [user]="user" />
        </button>

        <mat-divider vertical class="mx-2xs" style="height: 32px" />

        <a mat-button *ngFor="let link of USER_LINKS" color="primary" [routerLink]="link.path" routerLinkActive="active">{{ link.label }}</a>

        <button mat-button color="primary" (click)="logout()" i18n>Logout</button>
      </ng-container>

      <mat-divider vertical class="mx-2xs" style="height: 32px" />
    </ng-container>

    <button mat-button color="primary" [matMenuTriggerFor]="languageMenu" [disabled]="!localized" i18n>Language</button>
  </mat-toolbar-row>
</mat-toolbar>

<mat-menu xPosition="before" #languageMenu="matMenu">
  <a mat-menu-item *ngFor="let language of APP_LANGUAGES" href="/{{ language.locale }}/">
    <mat-icon fontSet="fp" [fontIcon]="language.icon" />
    {{ language.label }}
  </a>
</mat-menu>

<ng-template #public>
  <a mat-button color="primary" routerLink="/login" routerLinkActive="active" i18n>Login</a>
</ng-template>

<ng-template #mobile>
  <button mat-icon-button color="primary" (click)="sidenavToggle.emit()" aria-label="Toggle Navigation" class="me-3xs" i18n-aria-label>
    <mat-icon fontIcon="fa-bars" class="fs-large align-bottom" />
  </button>

  <div class="text-primary fs-normal text-truncate me-s">{{ options.applicationName }}</div>

  <span class="ms-2xs me-auto"></span>
</ng-template>
