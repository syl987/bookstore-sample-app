<mat-toolbar class="shadow">
  <mat-toolbar-row>
    <ng-container *ngIf="desktop$ | async; else mobile">
      <div class="text-primary fs-large me-s">{{ options.applicationName }}</div>

      <a mat-button *ngFor="let link of PUBLIC_LINKS" color="primary" [routerLink]="link.path" routerLinkActive="active">{{ link.label }}</a>

      <form [formGroup]="form" (ngSubmit)="search()">
        <mat-form-field appearance="fill" style="min-width: 268px">
          <mat-icon fontIcon="fa-search" inline class="text-primary" matPrefix />
          <input matInput formControlName="query" placeholder="Search..." aria-label="Search" />
          <mat-spinner *ngIf="searching$ | async" diameter="24" class="me-s" matSuffix />
        </mat-form-field>
      </form>

      <span class="ms-2xs me-auto"></span>

      <ng-container *ngIf="user$ | async as user; else public">
        <app-header-user-info [user]="user" class="px-2xs" />

        <mat-divider vertical class="mx-2xs" style="height: 32px" />

        <a mat-button *ngFor="let link of USER_LINKS" color="primary" [routerLink]="link.path" routerLinkActive="active">{{ link.label }}</a>

        <button mat-button color="primary" [matMenuTriggerFor]="settingsMenu">Settings</button>

        <mat-menu xPosition="before" #settingsMenu="matMenu">
          <button mat-menu-item (click)="openUserSessionInfoDialog(user)">Session Info</button>
        </mat-menu>

        <button mat-button color="primary" (click)="logout()" class="me-n2xs">Logout</button>
      </ng-container>
    </ng-container>
  </mat-toolbar-row>
</mat-toolbar>

<ng-template #public>
  <a *ngIf="displayLogin$ | async" mat-button color="primary" routerLink="/login" class="me-ns">Login</a>
</ng-template>

<ng-template #mobile>
  <button mat-icon-button color="primary" (click)="sidenavToggle.emit()" aria-label="Toggle Navigation" class="ms-nxs me-3xs">
    <mat-icon fontIcon="fa-bars" class="fs-large align-bottom" />
  </button>

  <div class="text-primary fs-normal me-s">{{ options.applicationName }}</div>
</ng-template>
